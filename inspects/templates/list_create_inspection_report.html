{% extends 'base.html' %} 
{% block content %}
{% load static %}
<script type="text/javascript" src="js/jquery.min.js"></script>
<script type="text/javascript" src="js/bootstrap.min.js"></script>
<script src="//code.jquery.com/jquery.min.js"></script>
<!-- <link rel="stylesheet" href="jquery.dropdown.css"> -->
<script src="jquery.dropdown.js"></script>
<!-- Include the plugin's CSS and JS: -->

<script type="text/javascript" src="js/bootstrap-multiselect.js"></script>
<link rel="stylesheet" href="css/bootstrap-multiselect.css" type="text/css"/>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">

<link rel="stylesheet" type="text/css" media="screen" href="{% static '/css/bootstrap.min.css' %}">

<link href="https://gitcdn.github.io/bootstrap-toggle/2.2.2/css/bootstrap-toggle.min.css" rel="stylesheet">
<script src="https://gitcdn.github.io/bootstrap-toggle/2.2.2/js/bootstrap-toggle.min.js"></script>

    <link rel="stylesheet" type="text/css" href="{% static '/css/select2.min.css' %}" />
    <link rel="stylesheet" type="text/css" media="screen" href="{% static '/css/select2.min.css' %}">
<link rel="stylesheet" href="//code.jquery.com/ui/1.12.1/themes/base/jquery-ui.css">


<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">

<script src="{% static 'js/timepicker.js' %}"></script>
<!-- <link rel="stylesheet" type="text/css" href="{% static '/css/select2.min.css' %}" /> -->

  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.1/css/bootstrap.min.css">
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>
  <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.1/js/bootstrap.min.js"></script>
   <!-- Select2 CSS --> 

<!-- jQuery --> <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script> 

<!-- Select2 JS --> 
<script src="https://cdn.jsdelivr.net/npm/select2@4.1.0-beta.1/dist/js/select2.min.js"></script>
<!-- Load icon library -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
<!-- multiple selesct marked officer -->

<link href="css/jquery.multiselect.css" rel="stylesheet" type="text/css">
<script src="https://cdn.datatables.net/1.11.5/js/jquery.dataTables.min.js"></script>
  <link href="https://cdn.datatables.net/1.11.5/css/jquery.dataTables.min.css"  rel="stylesheet"/>
  <!-- Sheets for datepicker for target date -->
  
  <link rel="stylesheet" href="//code.jquery.com/ui/1.13.1/themes/base/jquery-ui.css">
  <link rel="stylesheet" href="/resources/demos/style.css">
  <script src="https://code.jquery.com/ui/1.13.1/jquery-ui.js"></script>
<br>
    
    <style>
      * {
  box-sizing: border-box;
}
    
    
      input[type=text]
      {
              width: 100%;
              padding: 12px 20px;
              margin: 8px 0;
              display: block;
              /* border: 1.5px solid rgb(14, 12, 12); */
              border-radius: 4px;
              box-sizing: border-box;
      }
    
      input[type=submit] {
              width: 40%;
              text-align: center;
              background-color: #4CAF50;
             
              padding: 14px 20px;
              margin: 8px 0;
              border: none;
              border-radius: 4px;
              cursor: pointer;
      }
    
      input[type=submit]:hover {
              background-color: #45a049;
              text-align: center;
      }
    
    
      input[type=button]:hover {
              background-color: #45a049;
              text-align: center;
      }
      /* #viewbtn{
        margin-left:1050px;
      } */
    
      .inputtag{
        height:20px;
      }
      .button {
  padding: 15px 25px;
  font-size: 12px;
  text-align: center;
  margin-left: 2em;
  cursor: pointer;
  outline: none;
  color: #fff;
  background-color: #04AA6D;
  border: none;
  border-radius: 15px;
 
}

.button:hover {background-color: #3e8e41}

.button:active {
  background-color: #3e8e41;
  box-shadow: 0 5px #666;
  transform: translateY(4px);
}
    </style>
    
  
<body>
<h2 style="font-family: 'Times New Roman', Times, serif;">
    <center><b>Inspections Done by Me</b></center>
  </h2>

  <br>
  
  <div  class="col-sm-2s form-group" >
  
    <button class="button" style="height:6vh;width:25vh;margin-left:170vh;color:white;" ><a style="color: white;" href='{% url "create_inspection_form" %}' >Add New Inspection Report</a></button>
</div>

  <div class="container">
  <form  method="POST" class="d-inline " action = '{% url "created_checklist" %}'>
        
    {% csrf_token %}


   
  

<div class="row" id="row1" style="margin-left: 15em;">
    <div class="col-md-2"  >
        <label for="Zone" >Rly/Org</label><span style="color:red;font-weight:bold">*</span>
        <select class="form-control" id="zone" name="zone" class="custom-select"
            required><span style="color:red;font-weight:bold">*</span>
            <option value="All" selected>All</option>
            {% for z in Zone %}
            <option value="{{z}}">{{z}}</option>
            {% endfor %}

        </select>
    </div>

   
   
<div class="col-md-2">
    <label for="division">Division</label><span style="color:red;font-weight:bold">*</span>
    <select class="form-control" id="division" name="division" class="custom-select" style="max-width:100%;"
             required><span style="color:red;font-weight:bold">*</span>

            <option value="All" selected>All</option>
            {% for d in division %}
            <option value="{{d}}">{{d}}</option>
            {% endfor %}

        </select>
    
</div>
<div class="col-md-2">
  <label for="division">Department</label><span style="color:red;font-weight:bold">*</span>
  <select class="form-control" id="department" name="department" class="custom-select" style="max-width:100%;"
          onchange="fetch_department();" required>

          <option value="All" selected>All</option>
          {% for d in department %}
          <option value="{{d.department_name}}">{{d.department_name}}</option>
          {% endfor %}

      </select>
  
</div>

  <div  class="col-md-3" >
      <label for="location" >Location</label>
      <input  id="location" style="margin-top:0em ;height: 2em;" type="text" class="form-control"/>
      
  </div>
  <!-- <div  class="col-md-2" >
    <label for="start" style="margin-left:3.5vh;">From date</label>
    
        <input type="date" id="start" style="margin-top:0em ;margin-left:3.5vh;" class="form-control" name="From-start" required>
        <script>
          $(function(){
           var dtToday = new Date();
       
           var month = dtToday.getMonth() + 1;
           var day = dtToday.getDate();
           var year = dtToday.getFullYear();
       
           if(month < 10)
               month = '0' + month.toString();
           if(day < 10)
               day = '0' + day.toString();
       
           var maxDate = year + '-' + month + '-' + day;    
           $('#start').attr('max', maxDate);
       });
      
   </script>
        
        </div>
        <div  class="col-md-2">
        <label for="start" >To date</label>
           <input type="date"  class="form-control" id="txtDate2"  max="new Date()" required >
           <script>
           $(function(){
            var dtToday = new Date();
        
            var month = dtToday.getMonth() + 1;
            var day = dtToday.getDate();
            var year = dtToday.getFullYear();
        
            if(month < 10)
                month = '0' + month.toString();
            if(day < 10)
                day = '0' + day.toString();
        
            var maxDate = year + '-' + month + '-' + day;    
            $('#txtDate2').attr('max', maxDate);
        });
       
    </script>
    </div>
   -->
  <div  class="col-md-2 form-group" >
      
      <button  type="submit"  name="zone_loc_submit"  style="margin-top:2em;margin-left:5em;height:2.5em;width:6em;" class="btn btn-success btn-sm" id="insp_submit" onClick=" filterinspectiondata();popclose()">Submit</button>
  </div>
  </form>
  </div>
  <br><br>

  <div class="modern" >
    <table class="table table-striped table-bordered table-sm" id="instituteTable">
        <thead
            style="background-color: #343a40;white-space: nowrap;font-size: 1.5rem; color:white;text-align: left;">
            <th>S.No</th>
           
            <th >Inspection No.</th>
            <th >Inspection Title</th>
            <th >Railway</th>
            <th >Division</th>
            <th >Department</th>
            <th >Location</th>
            <th >Date of inspection</th>
            <th >View</th>
            <th >Reply</th>
            
           
            <!-- <th >Status</th> -->
           
        </thead>
        <tbody>

            {% for g in mydata %}
            <tr>
                <td>{{ forloop.counter }}</td>
                <!-- <td>{{ g.institute_name }}</td> -->
                <!-- <td>{{ g.id }}</td> -->
                <td>{{ g.inspection_no }}</td>
                <td>{{g.inspection_title}}</td>
                <td>{{g.zone}}</td>
                <td>{{g.division}}</td>
                <td>{{g.dept}}</td>
                <td>{{g.location}}</td>
                <td>{{g.inspected_on|date:'d-m-y'}}</td>
                <td><button type="button" class="btn btn-primary svBtn"><a href="/media{{g.report_path}}"  style="color: white;" target="blank">View Report </button></a></td>
                <td><button type="button" class="btn btn-primary svBtn"><a   style="color: white;" target="blank">Reply  </button></a></td>
                <!-- <td>{{g.status}}</td> -->
               
            </tr> 
            {% endfor %}
        </tbody>

    </table>
</div>
<br>



</body>   
<script>
  $(document).ready(function(){
    $('#instituteTable').DataTable();
  })

  $("#zone").select2();
 
         // Read selected option
         $('#rly').click(function(){
           var username = $('#rly option:selected').text();
           var userid = $('#rly').val();
       
          
       

         });
 
 $("#division").select2();
 
 $('#division').click(function(){
   var username = $('#div option:selected').text();
   var userid = $('#div').val();
});

 $("#department").select2();
 
 $('#department').click(function(){
   var username = $('#department option:selected').text();
   var userid = $('#department').val();
});


</script>
                                                                                                                                                                                                                                                                                              

<script>
  function filterinspectiondata(){
            var rly=$('#zone').val();
            var dept=$('#department').val();
            var div=$('#division').val();
            var loc=$('#location').val();
            alert(rly);
            alert(loc);
            alert(dept);
            alert(div);            
            var start_date=$('input#start').val();
            console.log(start_date,"%%%%%%%%%%")
            // alert(start_date);
           
            var end_date=$('input#txtDate2').val();
            console.log(end_date,"%%%%%%%%%%")
           
  }</script>
  <script>
    $(document).ready(function () {
        $('#instituteTable').DataTable();
    });
</script>
<script>
  $('#zone').change(function() {
var rly=$('#zone').val();

data={
  'rly':rly,
  
}

$.ajax({
type : 'GET',
url : "{% url 'getdiv_rly' %}",
dataType : 'json',
data : data,

success : function(response){
  division=response.division;
              $('#division').empty();
              $('#division').append(`<option value="">All</option>`);
              for (let i = 0; i < division.length; i++) {
              $('#division').append(`<option value="${division[i]}">
                                 ${division[i]}
                            </option>`);
                          }
}
   })
   })
</script>

{% endblock %}  